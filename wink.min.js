/**
 * A Tiny CSS Selector Engine —— wink
 * Copyright (c) 2013 lichen(http://leechan.me/)
 * -------------------------------------------------------
 * Dual licensed under the MIT and GPL licenses.
 *    - http://www.opensource.org/licenses/mit-license.php
 *    - http://www.gnu.org/copyleft/gpl.html
 * -------------------------------------------------------
 */
(function(){function f(b,c){if(!b||"string"!=typeof b)return[];if("string"==typeof b){if(c=c||document,b=b.replace(/^\s+|\s+$/g,""),a.test(b)){var d=b.charAt(0),e="#"===d?"id":"."===d?"class":"tag";return b="id"===e||"class"===e?b.substring(1):b,g(e,b,c)}if(c.querySelectorAll)return h(c.querySelectorAll(b));if(-1!==b.indexOf(",")){for(var m=b.split(","),n=[],o=0,p=m.length;p>o;o++)n=n.concat(f(m[o]));return l(n)}var q=b.match(/\S+/g),r=q.pop(),s=[],t=i(r),u=t.id,v=t.className,w=t.tagName,x=t.attrs;return s=u&&g("id",u,c)||[],s=s.length?w?j(s,w,function(a){return this.nodeName.toLowerCase()===a.toLowerCase()}):s:w?g("tag",w,c):[],s=s.length?v?j(s,v,function(a){return this.className===a}):s:v?g("class",v,c):[],s=s.length?x.length?j(s,x,function(a){return this.getAttribute(a[1])==a[2]}):s:x.length?j(g("tag","*",c),x,function(a){return this.getAttribute(a[1])===a[2]}):[],q.length?k(q,s):s}return[]}function g(a,b,c){var e=[];switch(a){case"id":el=document.getElementById(b),el&&e.push(el);break;case"class":if(c.getElementsByClassName)e=h(c.getElementsByClassName(b));else for(var f=c.all||c.getElementsByTagName("*"),g=0,i=f.length;i>g;g++){var j=f[g].className;j&&RegExp("\\s*"+b+"\\s*","g").test(j)&&e.push(f[g])}break;case"tag":e=h(c.getElementsByTagName(b))}return e}function h(a){try{return Array.prototype.slice.call(a)}catch(b){for(var c=[],d=0,e=a.length;e>d;++d)c.push(a[d]);return c}}function i(a){return{id:(a.match(b)||[])[1],className:(a.match(c)||[])[1],tagName:(a.match(d)||[])[1],attrs:a.match(e)||[]}}function j(a,b,c){for(var d=[],e=0,f=a.length;f>e;e++)c.call(a[e],b)&&d.push(a[e]);return d}function k(a,b,c){var d=a.pop(),e=[],f=[];if(">"===d){c=c||b;for(var g=k(a,c,!0,"return index of elements"),h=0,j=g.length;j>h;h++)e.push(b[g[h]]),f.push(c[g[h]]);return a.length?k(a,e,f):e}for(var l=i(d),m=l.id,n=l.className,o=l.tagName,p=l.attrs,q=4===arguments.length?!0:!1,r="object"==typeof c?c:b,s=0,t=b.length;t>s;s++){var u=(r[s]||b[s]).parentNode;do{if(!u)break;var v=!m||u.id===m;if(v=v&&(!o||o.toLowerCase()===u.nodeName.toLowerCase()),v=v&&(!n||RegExp("(^|\\s)"+n+"(\\s|$)").test(u.className)),v=v&&(!p.length||u.getAttribute(p[1])===p[2]),c===!0||v){v&&(f.push(u),q?e.push(s):e.push(b[s]));break}}while(u=u.parentNode)}return a.length>0?k(a,e,f):e}function l(a){for(var f,b=[],c=+new Date,d={},e=0;f=a[e++];)f.uid=f.uid||c+e,d[f.uid]||(b.push(f),d[f.uid]=f);return b}var a=/^[#\.\w][\w-]+$/,b=/#([\w\-_]+)/,c=/\.([\w\-_]+)/,d=/^([\w\-_\*]+)/,e=/\[([\w-]+)=[\"\']?([^\'\"]+)[\"\']?\]$/;this.wink=f})();